<div class="login-box">	

  <% if (cls==="MNG") {%>
  <h2>관리자 책 수정하기</h2>
  <% } else { %>
  <h2>내 책 수정하기</h2>
  <% } %>
  <form action="/book/update_process" method="post" enctype="multipart/form-data" style="margin-bottom: 20px;">
<!-- 
    <div class="form-group"><label>사진 올리기 </label></div>
    <div class="filebox">
      <input class="upload-name"  value="<%=book[0].image%>" placeholder="첨부파일" readonly>&nbsp;&nbsp; 
      <label for="file" class="btn-mini">파일찾기</label>&nbsp;&nbsp; 
      <input type="file" id="file" name="uploadFile" onchange="displayFileName()" style="display: none;" >
      
    </div> -->

    <div class="preview-box" style="margin-top: 10px;">
    <img id="previewImage" src="/images/<%=book[0].image%>" style="max-width: 200px; max-height: 200px; border: 1px solid #ccc; object-fit: contain;">
    </div>

      <input type="hidden" name="seller" value="<%=who%>" >
      <input type="hidden" name="bnum" value="<%=book[0].bnum%>" >
      
    
    <div class="form-group">
    <br>
      <label>책 제목</label>
      <input type="text" name="bookname" id="id" class="form-control large-input" value="<%=book[0].bookname%>">
    </div>

    <div class="form-group">
      <label>저자</label>
      <input type="text" name="author" class="form-control large-input" value="<%=book[0].author%>">
    </div>

    <div class="form-group">
      <label>가격</label>
      <input type="text" name="price" class="form-control large-input" value="<%=book[0].price%>" >
    </div>
    
    <div class="form-group">
      <label>내용</label>
      <textarea name="content" class="form-control large-input" rows="20" style="font-family: 'Arial', sans-serif; font-size:17px;"><%=book[0].content%></textarea>
    </div>

<% 
  const bigcateg = categ[0];  // results[0]
  const mincateg = categ[1];  // results[1]
%>
<div class="form-group">
  <label>대분류</label>
  <select id="categ1" name="categ1" required>
    <option value="" disabled>카테고리를 선택해주세요.</option>
    <% for (var k = 0; k < bigcateg.length; k++) {
         const isSelected = (bigcateg[k].bigcon === book[0].bigcon);
    %>
      <option value="<%=bigcateg[k].bigcon%>" <%= isSelected ? 'selected' : '' %>>
        <%=bigcateg[k].bigname%>
      </option>
    <% } %>
  </select>
</div>

<div class="form-group">
  <label>소분류</label>
  <select id="categ2" name="categ2" required>
    <option value="" disabled>카테고리를 선택해주세요.</option>
    <% for (var k = 0; k < mincateg.length; k++) {
         const isSelected = (mincateg[k].mincon === book[0].mincon);
    %>
      <option value="<%=mincateg[k].mincon%>" <%= isSelected ? 'selected' : '' %>>
        <%=mincateg[k].minname%>
      </option>



    <% } %>
  </select>
</div>

    <button type="submit" class="btn btn-primary big-login-btn">업로드</button>
  </form>
</div>

<script>
function displayFileName() {
    var input = document.getElementById('file');
    var fileName = input.files.length > 0 ? input.files[0].name : '';
    document.querySelector('.upload-name').value = fileName;

    // 이미지 미리보기
    if (input.files && input.files[0]) {
        var reader = new FileReader();
        reader.onload = function(e) {
            document.getElementById('previewImage').src = e.target.result;
        };
        reader.readAsDataURL(input.files[0]);
    }
}
</script>
